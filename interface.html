<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js">
    </script>
    
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <link rel='stylesheet' href='d3v4-selectable-zoomable-force-directed-graph.css'>
    <link rel="stylesheet" href="interface_style.css">
    

        
        
    <script src="https://d3js.org/d3.v4.js"></script>
    
<script src="js/d3v4-brush-lite.js"></script>
<script src="js/d3v4-selectable-force-directed-graph.js"></script>  
 

    
</head>
<body id="homePage" data-spy="scroll" data-target=".navbar" data-offset="50">
	
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#homePage">BioReact</a>
        </div>
        <div class="col-sm-3 col-md-3 pull-right">
            <div class="input-group">
<input type="search" id="search_species_name" placeholder="GTP" value="GTP" class="navbar_input" style="margin-right: 2px">
<input type="search" id="search_up_or_down" placeholder="down" value="down" class="navbar_input" style="width:80px;margin-right: 2px">
<input type="search" id="search_depth" placeholder="2" value="2" class="navbar_input" style="width:40px;margin-right: 2px">
<!--<input type="button" id="start" value="Start" onclick="location='Main.html'">-->
            </div>

<button id="search_name">Search Species Name</button>
<button id="check_result">Print Output</button>
<button id="combine_models">Combine Models</button>
            <form id="modelForm">
                <select id="selectModelNumber">
                </select>

            </form>
            <button id="generate_file" >Visualize Network</button>

            </div>



        </div>
    </div>
</nav>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-9">
            <div class="row">
                <div id="network_visualization" class="vis-genral">
                  <svg>

                  </svg>

                </div>
            </div>
        </div>
        <div class="col-md-3 mysidebar">
            <div><p class="sidebar-title">Search Result</p></div>
<!--            <div><input type="button" id="showResult" value="Show Result" onclick="createListFromJson()"></div> -->
            <div id="result-list" style="  display: flex; flex-flow: column wrap; align-items: center;">

            </div>
        </div>
    </div>
</div>	
	

<div id="search_name_"></div>
----------
<div id="join_models_"></div>
----------
<div id="demo"></div>
----------

</body>




<script>
	
    var listOfPaths = [];
    var numPaths = 0;
    
    var pathIndex = {};
    
    var currentSpeciesSearch = "";	




    
    $(document).ready(function () {
		
	
	function visualizeNetwork(graph, modelIndex) {
		var svg = d3.select('#network_visualization');

//		d3.json('data-sample.json', function(error, graph) {
//			if (!error) {
//				console.log('graph', graph);
				createV4SelectableForceDirectedGraph(svg, graph);
//			} else {
//				console.error(error);
//			}
//		});		

		createListFromJson(modelIndex);
		
		console.log(listOfPaths.length);
		console.log(numPaths);
		console.log(Object.keys(pathIndex));
	}
	

    //load without json file
    //var graph= JSON.parse(localStorage.dataForVis);
    //createV4SelectableForceDirectedGraph(svg, graph);




        function createListFromJson(modelIndex) {
            var sideBar_data="";
            var node_data=[];
            var element = [];
            var result_display=document.getElementById("result-list");
            result_display.innerHTML="";
            //load data to side bar
//            $.getJSON("data-sample.json", function(data) {



				data = listOfPaths[modelIndex];


                console.log(data); // this will show the info it in firebug console
                node_data=data["nodes"];
                for(i=0;i<countProperties(node_data);i++){
                    sideBar_data=node_data[i].id;
                    sideBar_content="#"+i+" "+"id: "+sideBar_data+" "+"group:"+node_data[i].group;
                    element[i]=document.createElement("input");
                    element[i].type="button";
                    element[i].onclick = function () {
                        //define the interaction here

			  console.log("#b-" + this.id);
			  d3.select("#b-" + this.id).attr("r",10);


                    };
                    



                    element[i].value=sideBar_content;
                    element[i].id=sideBar_data;
                    
                    //console.log("sideBar_data "+sideBar_data);
                    
                    element[i].type="button";
                    element[i].style="width:100%; font-size: 14px";
                    //append the element to the side bar
                    result_display.appendChild(element[i])
                }
//            });
        }
        function countProperties(obj) {
            return Object.keys(obj).length;
        }
        		
            $("#combine_models").click(function () {

                if (listOfPaths.length != numPaths) {
                    alert("Processing not finished yet");
                    return;
                }

				var combinedModel = {};
				combinedModel['nodes'] = [];
				combinedModel['links'] = [];

				//var speciesLookup = {};
				//var specRefLookup = {};
				
				var joiningSpecies = {};
				joiningSpecies['id'] = "joined_" + currentSpeciesSearch;
				joiningSpecies['reaction_name'] = currentSpeciesSearch;
				joiningSpecies['listOfJoiningSpecies'] = [];
				
				combinedModel['nodes'].push(joiningSpecies);
				
				var total_n = 0;
				var total_l = 0;
				
				var comb_n = 0;
				var comb_l = 0;
				
				comb_n += 1;
				
                for (var i = 0; i < listOfPaths.length; i++) {
                    var path = listOfPaths[i];
					//console.log(path['id']);					
					
					var model_id = path['id'].split("BIOMD")[1];
                    model_id = model_id.split(".rdf")[0];

					var nodes = path['nodes'];
					var links = path['links'];
					
					total_n += nodes.length;
					total_l += links.length;
					
					var joinedSpeciesId = "";
					
                    for (var j = 0; j < nodes.length; j++) {
						var node = nodes[j];
						
						var new_node = {}
						new_node['id']  = model_id+"_"+node['id'] ;
						
						if (node.hasOwnProperty('species_name')){
							var n = node['species_name'].localeCompare(currentSpeciesSearch);
							if (n == 0){
								joinedSpeciesId = node['id'];
								console.log(joinedSpeciesId);
								
								new_node['model'] = model_id;
								
								new_node['joined'] = 1;
								new_node['species_name'] = node['species_name'];
								new_node['group'] = i;
								
								joiningSpecies['listOfJoiningSpecies'].push(new_node);
								
								//speciesLookup[node['name']] = joiningSpecies['id'];
								
								
							} else {
								new_node['model'] = model_id;
								new_node['species_name'] = node['species_name'];
								new_node['group'] = i;
								
								combinedModel['nodes'].push(new_node);
								
								
								comb_n += 1;
							}
						} else {
							new_node['model'] = model_id;
							new_node['reaction_name'] = node['reaction_name'];
							new_node['group'] = i;
														

							combinedModel['nodes'].push(new_node);	

							
							comb_n += 1;						
						}
					}
					
					
					for (var k = 0; k < links.length; k++) {
						var specRef = links[k];
						
						var new_specRef = {}
						
						new_specRef['source'] =model_id+"_"+specRef['source'];
						new_specRef['target'] =model_id+"_"+specRef['target'];
						new_specRef['value'] = specRef['value'];
						
						if ((new_specRef['source'].slice(0,10)).localeCompare(new_specRef['source'].slice(11,21)) == 0){
							new_specRef['source'] = new_specRef['source'].slice(11);

							//console.log(specRef['source']);
						}
						
						if ((new_specRef['target'].slice(0,10)).localeCompare(new_specRef['target'].slice(11,21)) == 0){
							new_specRef['target'] = new_specRef['target'].slice(11);
							
							//console.log(specRef['target']);
						}						
						
						var n = joinedSpeciesId.localeCompare(specRef['source']);
						var m = joinedSpeciesId.localeCompare(specRef['target']);
						
												
						if (n == 0 && m == 0){
							new_specRef['source'] = joiningSpecies['id'];
							new_specRef['target'] = joiningSpecies['id'];
							
							//console.log("case 1");
						} 
						else if (m == 0) {
							new_specRef['target'] = joiningSpecies['id'];
							new_specRef['source'] = new_specRef['source'];
							
							//console.log("case 2");
							//console.log(specRef['source']);
							
						}
						else if (n == 0) {
							new_specRef['source'] = joiningSpecies['id'];
							new_specRef['target'] = new_specRef['target'];
							
							//console.log("case 3");
							//console.log(specRef['target']);
						} else {
							new_specRef['source'] = new_specRef['source'];
							new_specRef['target'] = new_specRef['target'];
							
							if ("0000000080_metaid_0000011".localeCompare(specRef['source']) == 0){
								console.log("_");
								console.log(joinedSpeciesId);
								console.log(specRef['source']);
								console.log(specRef['target']);
							}

						}
						
						combinedModel['links'].push(new_specRef);
						
						comb_l += 1;
					}
                }
                
                var out = JSON.stringify(combinedModel);
                document.getElementById("demo").innerHTML += out + "<br> <br>";
                
                console.log(total_n);
                console.log(total_l);
                console.log(comb_n);
                console.log(comb_l);
                console.log(joiningSpecies['listOfJoiningSpecies'].length);
                
                
                listOfPaths.push(combinedModel);
                
                    var select = document.getElementById("selectModelNumber"); 

					var opt = "combined model";
					var el = document.createElement("option");
					el.textContent = opt;
					el.value = opt;
					select.appendChild(el);
					
					pathIndex["combined model"] = listOfPaths.length - 1;
					
					console.log(listOfPaths.length - 1);
					numPaths += 1;
					
					console.log(listOfPaths.length);
					console.log(numPaths);
					console.log(Object.keys(pathIndex));
                
            });

        $("#check_result").click(function () {

            if (listOfPaths.length != numPaths) {
                alert("Processing not finished yet");
                return;
            }

            console.log("check_result listOfPaths.length " + listOfPaths.length);

            for (var i = 0; i < listOfPaths.length; i++) {
                var path = listOfPaths[i];
                var out = JSON.stringify(path);
                document.getElementById("demo").innerHTML += out + "<br> <br>";

            }

            //generate data over here
            //generateData(listOfPaths);
        });


        $("#search_name").click(function () {
            $.getJSON("multiple_name_sp.json", function (data) {
				
                listOfPaths = []
                numPaths = 0;
                pathIndex = {}
                
                $('#selectModelNumber').empty();
                currentSpeciesSearch = $('#search_species_name').val();

                var loc = window.location.pathname;
                var dir = loc.substring(0, loc.lastIndexOf('/')) + '/ftp.ebi.ac.uk/json/';

                var parent_dir = loc.substring(0, loc.lastIndexOf('/'))
                var multiple_name = parent_dir + "/multiple_name_sp.json"
                var multiple_id = parent_dir + "/stat.json"

                var div = document.getElementById("search_name_");

                var search_name = document.getElementById("search_species_name").value;
                var search_up_or_down = document.getElementById("search_up_or_down").value;
                var search_depth = document.getElementById("search_depth").value;

                if ($('#search_species_name').val() == '' || $('#search_up_or_down').val() == '' || $('#search_depth').val() == '') {
                    console.log("empty");
                    return;
                }

                var name = data[search_name];
                var search_depth = parseInt(search_depth);

                var keys = Object.keys(name);

                var arrayLength = keys.length;
                //div.innerHTML += "GTP :" + arrayLength + "<br>"

                for (var i = 0; i < arrayLength; i++) {
                    var model = keys[i];
                    var id = name[model];

                    //div.innerHTML += " :" + model + " " + id + "<br>"
                    var modelId = model.split(".")[0];
                    pathIndex[modelId] = i;
                    console.log(modelId);

                    model = "BIOMD" + model;
                    var file = dir + model;

                    var path = searchSpecies(file, id, search_depth, multiple_name, multiple_id, search_up_or_down);


                }

                numPaths = arrayLength;
            });
        });


        function searchSpecies(file, id, depth, multiple_name, multiple_id, search_up_or_down) {

            var path;

            var modelJson, multiple_nameLookup, multiple_idLookup;
            var div = document.getElementById("search_name_");
            //div.innerHTML += file + "<br>"
            //div.innerHTML += multiple_name + "<br>"
            //div.innerHTML += multiple_id + "<br>"
            
            var model_id;

            $.when(
                $.getJSON(file, function (data) {
                    modelJson = data;
                }),
                $.getJSON(multiple_name, function (data) {
                    multiple_nameLookup = data;
                }),

                $.getJSON(multiple_id, function (data) {
                    multiple_idLookup = data;
                })
            ).then(function () {

                var nodes = modelJson["nodes"];
                var links = modelJson["links"];
                var path = new Array();
                for (var i = 0; i < nodes.length; i++) {
                    node = nodes[i]
                    if (node.hasOwnProperty('species_name')) {

                        var n = id.localeCompare(node["id"]);

                        if (n == 0) {
                            //div.innerHTML += " :" + node["id"] + "<br>"
                            model_id = file.split("BIOMD")[1];
                            model_id = model_id.split(".rdf")[0];

                            var n = search_up_or_down.localeCompare("down");

                            if (n == 0) {
                                path = traverseGraphDown(nodes, links, node, model_id, depth, multiple_nameLookup, multiple_idLookup)
                                console.log("up");
                            } else {
                                path = traverseGraphUp(nodes, links, node, model_id, depth, multiple_nameLookup, multiple_idLookup)
                                console.log("down");
                            }

                            //div.innerHTML += " " + id + " "+model_id +" "+ path.length  + "<br>"
                            path["id"] = file;
                            listOfPaths.push(path);

                        }
                    }
                }

                div.innerHTML += "Added path for name=" + id + " model=" + model_id + " to results. Processed " + listOfPaths.length + " out of " + numPaths + "<br>";
                
                var select = document.getElementById("selectModelNumber"); 

					var opt = model_id;
					var el = document.createElement("option");
					el.textContent = opt;
					el.value = opt;
					select.appendChild(el);


            });
        }

        function traverseGraphDown(nodes, links, startNode, model_id, depth, multiple_nameLookup, multiple_idLookup) {
            var path = {};

            var currentDepth = 0;
            var numNodesToNextLevel = 1;
            var numNextLevelNodes = 0;

            var loc = window.location.pathname;
            var dir = loc.substring(0, loc.lastIndexOf('/'));


            var mult_name_keys = Object.keys(multiple_nameLookup);
            var mult_id_keys = Object.keys(multiple_idLookup);
            var div = document.getElementById("join_models_");

            var recurDepthStr = "===";
            var queue = [];

            queue.push(startNode);
            nodeIds = {};
            path['nodes'] = [];
            path['links'] = [];
            startNode['group'] = 1;

            path['nodes'].push(startNode);
            nodeIds[startNode['id']] = startNode['id'];

            while (queue.length > 0) {
                var node = queue.shift();
                numNodesToNextLevel = numNodesToNextLevel - 1;

                if (currentDepth >= depth) {
                    break;
                }

                if (node.hasOwnProperty('species_name')) {

                    //div.innerHTML += " ::" + mult_name_keys.length + " " + mult_id_keys.length + " " + node['species_name'] + " " + model_id + "<br>"

                    for (var k = 0; k < links.length; k++) {
                        var specRef = links[k];
                        var n = node['id'].localeCompare(specRef['source']);

                        if (n == 0) {
                            //div.innerHTML += "::     "+recurDepthStr + specRef['id'] + " " + specRef['target']  + "<br>"
                            path['links'].push(specRef);

                            for (var i = 0; i < nodes.length; i++) {
                                var childNodeRxn = nodes[i];

                                n = childNodeRxn['id'].localeCompare(specRef['target']);

                                if (n == 0) {
                                    //div.innerHTML += "::     "+recurDepthStr + childNodeRxn['id'] + "<br>"
                                    queue.push(childNodeRxn);
                                    childNodeRxn['group'] = 1;

                                    if (childNodeRxn['id'] in nodeIds) {
                                        //console.log(childNodeRxn['id']);
                                    } else {
                                        path['nodes'].push(childNodeRxn);
                                        nodeIds[childNodeRxn['id']] = childNodeRxn['id'];
                                    }

                                    numNextLevelNodes = numNextLevelNodes + 1;
                                }
                            }
                        }
                    }
                }
                if (node.hasOwnProperty('reaction_name')) {
                    //div.innerHTML += " :::" +  node['reaction_name']  + "<br>"

                    var productLinks = node['products'];
                    var productMap = productLinks.reduce(function (map, obj) {
                        map[obj] = obj;
                        return map;
                    }, {});

                    for (var j = 0; j < links.length; j++) {
                        var specRef = links[j];

                        if (specRef['id'] in productMap) {
                            //div.innerHTML += ":::     "+recurDepthStr + specRef['id'] + " " + specRef['target']  + "<br>"
                            path['links'].push(specRef);

                            for (var x = 0; x < nodes.length; x++) {
                                var childNodeSp = nodes[x];

                                n = childNodeSp['id'].localeCompare(specRef['target']);

                                if (n == 0) {
                                    //div.innerHTML += ":::     "+recurDepthStr + childNodeSp['id'] + "<br>"
                                    queue.push(childNodeSp);
                                    childNodeSp['group'] = 1;

                                    if (childNodeSp['id'] in nodeIds) {
                                    } else {
                                        path['nodes'].push(childNodeSp);
                                        nodeIds[childNodeSp['id']] = childNodeSp['id'];
                                    }

                                    numNextLevelNodes = numNextLevelNodes + 1;
                                }
                            }
                        }
                    }
                }

                if (numNodesToNextLevel == 0) {
                    currentDepth = currentDepth + 1;
                    recurDepthStr += "=";
                    numNodesToNextLevel = numNextLevelNodes;
                    numNextLevelNodes = 0;
                }
            }

            //div.innerHTML += " "+ model_id +" "+currentDepth+ "<br>"
            return path;

        }

        function traverseGraphUp(nodes, links, startNode, model_id, depth, multiple_nameLookup, multiple_idLookup) {
            var path = {};

            var currentDepth = 0;
            var numNodesToNextLevel = 1;
            var numNextLevelNodes = 0;

            var loc = window.location.pathname;
            var dir = loc.substring(0, loc.lastIndexOf('/'));


            var mult_name_keys = Object.keys(multiple_nameLookup);
            var mult_id_keys = Object.keys(multiple_idLookup);
            var div = document.getElementById("join_models_");

            var recurDepthStr = "===";
            var queue = [];

            queue.push(startNode);
            nodeIds = {}
            path['nodes'] = [];
            path['links'] = [];
            startNode['group'] = 1

            path['nodes'].push(startNode);
            nodeIds[startNode['id']] = startNode['id'];

            while (queue.length > 0) {
                var node = queue.shift();
                numNodesToNextLevel = numNodesToNextLevel - 1;

                if (currentDepth >= depth) {
                    break;
                }

                if (node.hasOwnProperty('species_name')) {

                    //div.innerHTML += " ::" + mult_name_keys.length + " " + mult_id_keys.length + " " + node['species_name'] + " " + model_id + "<br>"

                    for (var k = 0; k < links.length; k++) {
                        var specRef = links[k];
                        var n = node['id'].localeCompare(specRef['target']);

                        if (n == 0) {
                            //div.innerHTML += "::     "+recurDepthStr + specRef['id'] + " " + specRef['target']  + "<br>"
                            path['links'].push(specRef);

                            for (var i = 0; i < nodes.length; i++) {
                                var childNodeRxn = nodes[i];

                                n = childNodeRxn['id'].localeCompare(specRef['source']);

                                if (n == 0) {
                                    //div.innerHTML += "::     "+recurDepthStr + childNodeRxn['id'] + "<br>"
                                    queue.push(childNodeRxn);
                                    childNodeRxn['group'] = 1

                                    if (childNodeRxn['id'] in nodeIds) {
                                        //console.log(childNodeRxn['id']);
                                    } else {
                                        path['nodes'].push(childNodeRxn);
                                        nodeIds[childNodeRxn['id']] = childNodeRxn['id'];
                                    }

                                    numNextLevelNodes = numNextLevelNodes + 1;
                                }
                            }
                        }
                    }
                }
                if (node.hasOwnProperty('reaction_name')) {
                    //div.innerHTML += " :::" +  node['reaction_name']  + "<br>"

                    var productLinks = node['reactants'];
                    var productMap = productLinks.reduce(function (map, obj) {
                        map[obj] = obj;
                        return map;
                    }, {});

                    for (var j = 0; j < links.length; j++) {
                        var specRef = links[j];

                        if (specRef['id'] in productMap) {
                            //div.innerHTML += ":::     "+recurDepthStr + specRef['id'] + " " + specRef['target']  + "<br>"
                            path['links'].push(specRef);

                            for (var x = 0; x < nodes.length; x++) {
                                var childNodeSp = nodes[x];

                                n = childNodeSp['id'].localeCompare(specRef['source']);

                                if (n == 0) {
                                    //div.innerHTML += ":::     "+recurDepthStr + childNodeSp['id'] + "<br>"
                                    queue.push(childNodeSp);
                                    childNodeSp['group'] = 1

                                    if (childNodeSp['id'] in nodeIds) {
                                    } else {
                                        path['nodes'].push(childNodeSp);
                                        nodeIds[childNodeSp['id']] = childNodeSp['id'];
                                    }

                                    numNextLevelNodes = numNextLevelNodes + 1;
                                }
                            }
                        }
                    }
                }

                if (numNodesToNextLevel == 0) {
                    currentDepth = currentDepth + 1;
                    recurDepthStr += "=";
                    numNodesToNextLevel = numNextLevelNodes;
                    numNextLevelNodes = 0;
                }
            }

            //div.innerHTML += " "+ model_id +" "+currentDepth+ "<br>"
            return path;
        }


        <!--Codes for Visualization-->
        <!--count of the elements in the object-->
        function countProperties(obj) {
            return Object.keys(obj).length;
        }

        //Input the useful data into a json file
        $("#generate_file").click(function (){

            //clear the remaining result in the side bar
            var side

            if (listOfPaths.length != numPaths) {
                alert("Processing not finished yet");
                return;
        }


            <!--Create a new object-->
            var nodeArray = new Array();
            var linkArray = new Array();
            var jsonObject={
                nodes:nodeArray,
                links:linkArray
            };

            <!--parse the searching result-->
//            for (i = 0; i < countProperties(listOfPaths); i++) {



			var e = document.getElementById("selectModelNumber");
			var modelId = e.options[e.selectedIndex].value;

			console.log(modelId);
			var modelIndex = pathIndex[modelId];
			console.log(modelIndex);

                var path_filter = listOfPaths[modelIndex];
                var nodes_filter = path_filter.nodes;
                var links_filter = path_filter.links;

                // define objects for node and link respectively
                //initialize with some self-defined value
                //In object we must assign a value for each variable
    
                console.log(nodes_filter.length);
                console.log(links_filter.length);

                for (m = 0; m < countProperties(nodes_filter); m++) {
					
					var nodeObject={
						id:"default",
						type:"species",
						name:"GTP",
						group:"1"
					};
				
			
                    var node_filter = nodes_filter[m];
                    var id_filter = node_filter.id;
                    var group_filter = node_filter.group;
                    var name_filter="name";
                    var type_filter="type";
                    //Here judge whether the node is species or reaction
                    if(node_filter.hasOwnProperty('species_name')){
                        name_filter = node_filter['species_name'];
                        type_filter = "species";
                    }else if(node_filter.hasOwnProperty('reaction_name')){
                        name_filter = node_filter['reaction_name'];
                        type_filter ="reactions";
                    }else{name_filter = "null"; type_filter="unknown"}
                    nodeObject.id = id_filter;
                    nodeObject.group = group_filter;
                    nodeObject.type = type_filter;
                    nodeObject.name = name_filter;
                    //put the object into the array
                    nodeArray.push(nodeObject);
                }
                for (n = 0; n < countProperties(links_filter); n++) {
					
					var linkObject={
						source:"testSource",
						target:"testTarget",
						value:"1"
					};	
					
                    var link_filter = links_filter[n];
                    var source_filter = link_filter['source'];
                    var target_filter = link_filter['target'];
                    var value_filter = link_filter['value'];
                    linkObject.source= source_filter;
                    linkObject.target= target_filter;
                    //there is a problem that the value of some(ok to add 1 to the value?)
                    linkObject.value = value_filter;
                    //put the obeject into the array
                    linkArray.push(linkObject);
                }
 //           }
            console.log(jsonObject);
            //save the data to the local storage
            localStorage.dataForVis = JSON.stringify(jsonObject);
            //readout data
            var obj = JSON.parse(localStorage.dataForVis);
            console.log(obj);
//            //download the obj
//            saveText( JSON.stringify(jsonObject), "filtered_data.json" );
            //put the jsonObject to a jason file
            //using node.js
//            var fs=require("fs");
//            fs.writeFile("./.json", JSON.stringify(jsonObject), (err) => {
//                if (err) {
//                    console.error(err);
//                    return;
//                };
//            console.log("File has been created");
//        });

		console.log(listOfPaths.length);
		console.log(numPaths);
		console.log(Object.keys(pathIndex));

			visualizeNetwork(jsonObject, modelIndex);


        });

		function download(filename, text) {
			var pom = document.createElement('a');
			pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
			pom.setAttribute('download', filename);

			if (document.createEvent) {
				var event = document.createEvent('MouseEvents');
				event.initEvent('click', true, true);
				pom.dispatchEvent(event);
			}
			else {
				pom.click();
			}
		}

        //download the file
        function saveText(text, filename){
            var a = document.createElement('a');
            a.setAttribute('href', 'data:text/plain;charset=utf-u,'+encodeURIComponent(text));
            a.setAttribute('download', filename);
            a.click()
        }


    });
</script>
</html>
